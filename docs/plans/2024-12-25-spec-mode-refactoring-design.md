# Spec Mode ë¦¬íŒ©í† ë§ ì„¤ê³„

## ê°œìš”

í˜„ì¬ Spec ëª¨ë“œì˜ ìƒíƒœ ê´€ë¦¬ê°€ ë‚œì¡í•˜ê³  í”Œë¡œìš°ê°€ ë¶€ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ë¦¬íŒ©í† ë§ ì„¤ê³„.

### í˜„ì¬ ë¬¸ì œì 

1. **ìˆ˜ë™ ìƒíƒœ ì „ì´**: ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ í‚¤ì›Œë“œ ê°ì§€ â†’ ì˜¤íƒ/ë¯¸íƒ ì¦ìŒ
2. **XML íŒŒì‹± ì¡°ê±´ ë³µì¡**: Fast vs Spec(task) vs Spec(requirements/plan) ë¶„ê¸°ê°€ 10ë²ˆ ì´ìƒ ë°˜ë³µ
3. **ì—­ë°©í–¥ ì „ì´ ë¶ˆê°€**: Plan ë‹¨ê³„ì—ì„œ ìš”êµ¬ì‚¬í•­ ì¶”ê°€ ì‹œ ëŒì•„ê°ˆ ìˆ˜ ì—†ìŒ
4. **UI ì¸ë””ì¼€ì´í„° ë‹¨ìˆœ**: ì„¸ë¶€ ì§„í–‰ ìƒí™© ì—†ìŒ

---

## í•µì‹¬ ì„¤ê³„ ë³€ê²½

### 1. ìƒíƒœ ì¤‘ì‹¬ â†’ ë¬¸ì„œ ì¤‘ì‹¬ ì„¤ê³„

```typescript
// Before: ìƒíƒœ ì¤‘ì‹¬
type SpecStage = 'idle' | 'requirements' | 'plan' | 'task';

// After: ë¬¸ì„œ ì¤‘ì‹¬
interface SpecDocument {
  id: string;
  version: number;
  requirements: RequirementItem[];
  plan: PlanPhase[];
  currentFocus: 'requirements' | 'planning' | 'executing';
  lastModified: Date;
}

interface RequirementItem {
  id: string;
  text: string;
  status: 'pending' | 'confirmed' | 'modified';
  source: 'user' | 'ai';
  createdAt: Date;
}

interface PlanPhase {
  id: string;
  title: string;
  tasks: PlanTask[];
  status: 'pending' | 'in-progress' | 'completed';
}

interface PlanTask {
  id: string;
  text: string;
  completed: boolean;
  files?: string[];  // ê´€ë ¨ íŒŒì¼ ê²½ë¡œ
}
```

### 2. AI ì œì•ˆ + ì‚¬ìš©ì í™•ì¸ ë°©ì‹

AI ì‘ë‹µì— ë©”íƒ€ë°ì´í„°ë¥¼ í¬í•¨í•˜ì—¬ ìƒíƒœ ì „ì´ ì œì•ˆ:

```xml
<boltResponse>
  <specAction type="suggest_transition" to="planning">
    ìš”êµ¬ì‚¬í•­ì´ ì¶©ë¶„íˆ ì •ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.
  </specAction>
  
  <specAction type="add_requirement">
    ë‹¤í¬ëª¨ë“œ ì§€ì›
  </specAction>
  
  <message>
    ìš”êµ¬ì‚¬í•­ì´ ëª…í™•í•´ì¡Œë„¤ìš”! ê³„íš ë‹¨ê³„ë¡œ ë„˜ì–´ê°ˆê¹Œìš”?
  </message>
</boltResponse>
```

UIì—ì„œ ì¸ë¼ì¸ í™•ì¸ ë²„íŠ¼ í‘œì‹œ:
```
AI: "ìš”êµ¬ì‚¬í•­ì´ ëª…í™•í•´ì¡Œë„¤ìš”!"
    [ğŸ‘ ê³„íš ë‹¨ê³„ë¡œ ì§„í–‰] [ğŸ’¬ ë” ë…¼ì˜í•˜ê¸°]
```

### 3. ì—­ë°©í–¥ ì „ì´ ì§€ì›

Plan ì™„ë£Œ í›„ ì¶”ê°€ ìš”êµ¬ì‚¬í•­ â†’ AIê°€ ìë™ ê°ì§€í•˜ì—¬ ì²˜ë¦¬:

```typescript
// AIê°€ ë©”ì‹œì§€ ë¶„ì„ í›„ specAction ê²°ì •
<specAction type="add_requirement">
  ë‹¤í¬ëª¨ë“œ ì§€ì›
</specAction>
<specAction type="update_plan" phase="3">
  ë‹¤í¬ëª¨ë“œ ê´€ë ¨ íƒœìŠ¤í¬ ì¶”ê°€
</specAction>
```

---

## Spec íƒ­ UI ì„¤ê³„

### íƒ­ ì¶”ê°€

```typescript
// TopBar.tsx - TABS ë°°ì—´
{
  id: 'spec',
  label: 'Spec',
  icon: <ClipboardList size={16} />
}

// types/index.ts
type TabType = 'canvas' | 'code' | 'assets' | 'dashboard' | 'spec';
```

### Spec Panel êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“‹ Project Spec                          [v3] [â†»] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€ Requirements â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ âœ“ ë¸”ë¡œê·¸ ì‚¬ì´íŠ¸                    [ìˆ˜ì •][ì‚­ì œ]â”‚ â”‚
â”‚  â”‚ âœ“ í¬ìŠ¤íŠ¸ CRUD                      [ìˆ˜ì •][ì‚­ì œ]â”‚ â”‚
â”‚  â”‚ â— ë‹¤í¬ëª¨ë“œ (NEW)                   [ìˆ˜ì •][ì‚­ì œ]â”‚ â”‚
â”‚  â”‚ [+ ìš”êµ¬ì‚¬í•­ ì¶”ê°€]                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                     â”‚
â”‚  â”Œâ”€ Implementation Plan â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â–¸ Phase 1: ê¸°ë³¸ ë ˆì´ì•„ì›ƒ          [3 tasks]   â”‚ â”‚
â”‚  â”‚ â–¸ Phase 2: í¬ìŠ¤íŠ¸ ê¸°ëŠ¥            [5 tasks]   â”‚ â”‚
â”‚  â”‚ [ê³„íš ì¬ìƒì„±] [ìˆ˜ë™ í¸ì§‘]                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                     â”‚
â”‚  â”Œâ”€ Current Focus â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ¯ Planning - "êµ¬ì¡° ì„¤ê³„ ì¤‘"                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ğŸ’¬ Chatìœ¼ë¡œ ìˆ˜ì •]           [ğŸš€ ì½”ë“œ ì‘ì„± ì‹œì‘]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Chat â†” Spec ì—°ë™

| ë°©í–¥ | ë™ì‘ |
|------|------|
| Chat â†’ Spec | AI ì‘ë‹µì˜ `<specAction>` íŒŒì‹± â†’ Spec ë¬¸ì„œ ìë™ ì—…ë°ì´íŠ¸ |
| Spec â†’ Chat | [ìˆ˜ì •] ë²„íŠ¼ â†’ "ìš”êµ¬ì‚¬í•­ Xë¥¼ ìˆ˜ì •í•´ì¤˜" ë©”ì‹œì§€ ìë™ ìƒì„± |
| ì–‘ë°©í–¥ ë™ê¸°í™” | `spec-store.ts`ë¥¼ í†µí•œ ìƒíƒœ ê³µìœ  |

---

## êµ¬í˜„ ê³„íš

### Phase 1: ë°ì´í„° ëª¨ë¸ ë° Store

#### [NEW] `src/stores/spec-store.ts`
- `SpecDocument` ìƒíƒœ ê´€ë¦¬
- CRUD ì•¡ì…˜ ì •ì˜

#### [MODIFY] `src/stores/chat-store.ts`
- `specStage` ì œê±°
- `spec-store` ì—°ë™

### Phase 2: AI ì‘ë‹µ íŒŒì‹± í™•ì¥

#### [MODIFY] `src/lib/streaming-parser.ts`
- `<specAction>` íƒœê·¸ íŒŒì‹± ì¶”ê°€

#### [MODIFY] `src/constants/prompts.ts`
- Spec ëª¨ë“œ í”„ë¡¬í”„íŠ¸ì— `<specAction>` í˜•ì‹ ì¶”ê°€

### Phase 3: Spec íƒ­ UI

#### [NEW] `src/components/spec/SpecPanel.tsx`
- ë©”ì¸ Spec íŒ¨ë„ ì»´í¬ë„ŒíŠ¸

#### [NEW] `src/components/spec/RequirementsList.tsx`
- ìš”êµ¬ì‚¬í•­ ëª©ë¡ ë° CRUD

#### [NEW] `src/components/spec/PlanViewer.tsx`
- ê³„íš ë·°ì–´ ë° ì§„í–‰ ìƒí™©

#### [MODIFY] `src/components/shell/TopBar.tsx`
- Spec íƒ­ ì¶”ê°€

#### [MODIFY] `src/components/shell/MainContent.tsx`
- SpecPanel ì—°ë™

### Phase 4: Chat ì—°ë™

#### [MODIFY] `src/components/shell/AgentChat.tsx`
- `<specAction>` ì²˜ë¦¬ ë¡œì§
- ì¸ë¼ì¸ í™•ì¸ ë²„íŠ¼ UI

---

## ê²€ì¦ ê³„íš

### ìë™í™” í…ŒìŠ¤íŠ¸
- Spec Store ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- specAction íŒŒì‹± í…ŒìŠ¤íŠ¸

### ìˆ˜ë™ ê²€ì¦
1. ìƒˆ ëŒ€í™” ì‹œì‘ â†’ ìš”êµ¬ì‚¬í•­ ì¶”ê°€ â†’ Spec íƒ­ì— ë°˜ì˜ í™•ì¸
2. ê³„íš ìƒì„± í›„ â†’ ì¶”ê°€ ìš”êµ¬ì‚¬í•­ â†’ ì—­ë°©í–¥ ì—…ë°ì´íŠ¸ í™•ì¸
3. Spec íƒ­ì—ì„œ ìˆ˜ì • â†’ Chatì— ë©”ì‹œì§€ ì „ì†¡ í™•ì¸
4. [ğŸš€ ì½”ë“œ ì‘ì„± ì‹œì‘] â†’ ì‹¤í–‰ ëª¨ë“œ ì „í™˜ í™•ì¸
